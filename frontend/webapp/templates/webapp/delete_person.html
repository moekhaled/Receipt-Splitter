{% extends "webapp/base.html" %}

{% block title %}Delete Person{% endblock %}

{% block content %}
<div id="delete-container">
    <h2>Delete Person</h2>

    {% if error %}
        <p class="warning-text">{{ error }}</p>
    {% endif %}

    {% if person %}
        <p>
            Are you sure you want to delete:
            <strong>{{ person.name }}</strong>?
        </p>

        {% if person.items %}
            <p class="muted-text">
                This will also remove {{ person.items|length }} item{{ person.items|length|pluralize }}.
            </p>
        {% endif %}
    {% else %}
        <p class="warning-text">Person not found.</p>
    {% endif %}

    <form method="post">
        {% csrf_token %}

        <button type="submit" class="btn-delete" {% if not person %}disabled{% endif %}>
            Yes, Delete
        </button>

        {# Cancel must not rely on ORM relations like person.session.pk #}
        {% if session_pk and person.id %}
            <a href="{% url 'person-details' session_pk=session_pk person_pk=person.id %}" class="btn-cancel">
                Cancel
            </a>
        {% elif session_pk %}
            <a href="{% url 'session-details' session_pk=session_pk %}" class="btn-cancel">
                Cancel
            </a>
        {% else %}
            <a href="{% url 'all-sessions' %}" class="btn-cancel">
                Cancel
            </a>
        {% endif %}
    </form>
</div>
{% endblock %}
